<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <title>优惠券</title>    <link rel="stylesheet" href="../css/index.css">    <link rel="stylesheet" type="text/css" href="../css/common.css">    <style>        .con_in{            width: 120px;            display: inline-block;            margin: 0 5px;        }        .con_in input{            /*border-radius: ;*/        }    </style></head><body><div id="app" class="customer">    <template>        <p class="cus_title">            <el-breadcrumb separator-class="el-icon-arrow-right">                <el-breadcrumb-item><a href="home.html" target="iframe">工作台首页</a></el-breadcrumb-item>                <el-breadcrumb-item>优惠券</el-breadcrumb-item>            </el-breadcrumb>        </p>        <div class="cus_center over_hidden">            <el-button type="success" class="fr" @click="addDialogVisible = true">新增优惠券</el-button>        </div>        <el-table border :max-height="max_ht" :data="con_list" style="width: 100%">            <el-table-column                    label="类型">                <template slot-scope="scope">                    <i v-if="scope.row.coupon_type==1">满减</i>                    <i v-if="scope.row.coupon_type==2">满折</i>                    <i v-if="scope.row.coupon_type==3">满赠</i>                </template>            </el-table-column>            <el-table-column                    label="名称"                    prop="coupon_name" min-width="80">            </el-table-column>            <el-table-column                    label="优惠券属性">                <template slot-scope="scope">                    <i v-if="scope.row.coupon_type==1"> 满{{scope.row.enough}}减{{scope.row.dedut}}</i>                    <i v-if="scope.row.coupon_type==2"> 满{{scope.row.enough}}减{{scope.row.send}}</i>                    <i v-if="scope.row.coupon_type==3"> 满{{scope.row.enough}}减{{scope.row.discount}}</i>                </template>            </el-table-column>            <el-table-column                    label="余量"                    prop="coupon_num" min-width="80">            </el-table-column>            <el-table-column                    label="操作">                <template slot-scope="scope">                    <el-button size="mini" type="primary" plain @click="detail=scope.row;setVal();editDialogVisible=true">编辑                    </el-button>                    <el-button size="mini" type="danger" plain @click="del(scope.row.id)">删除                    </el-button>                </template>            </el-table-column>        </el-table>        <!--新增优惠券-->        <el-dialog                title="新增优惠券"                :visible.sync="addDialogVisible"                min-width="400px"                center                :before-close="close">            <ul class="goods_edit">                <li>                    <span class="list_left">类型</span>                    <span class="list_right">                    <el-select v-model="coupon.type" placeholder="请选择">                        <el-option                                value="1" label=" 满减">                        </el-option>                    </el-select>                </span>                </li>                <li>                    <span class="list_left">名称</span>                    <span class="list_right">                    <el-input v-model="coupon.name" placeholder="请输入优惠券名称"></el-input>                </span>                </li>                <li>                    <span class="list_left">属性</span>                    <span class="list_right">                    满<el-input v-model="coupon.enough" placeholder="0.00" class="con_in"></el-input>减<el-input v-model="coupon.deductible" placeholder="0.00" class="con_in"></el-input>                </span>                </li>                <li>                    <span class="list_left">数量</span>                    <span class="list_right">                    <el-input v-model="coupon.num" placeholder="请输入数量" class="con_in"></el-input>                </span>                </li>            </ul>            <span slot="footer" class="dialog-footer">            <el-button @click="close">取 消</el-button>            <el-button type="primary" @click="add()">确 定</el-button>          </span>        </el-dialog>        <!--编辑优惠券-->        <el-dialog                title="编辑优惠券"                :visible.sync="editDialogVisible"                min-width="400px"                center                :before-close="close">            <ul class="goods_edit">                <li>                    <span class="list_left">类型</span>                    <span class="list_right">                    <el-select v-model="edit_data.coupon_type" placeholder="请选择">                        <el-option                                value="1">                            满减                        </el-option>                    </el-select>                </span>                </li>                <li>                    <span class="list_left">名称</span>                    <span class="list_right">                    <el-input v-model="edit_data.coupon_name" placeholder="请输入优惠券名称"></el-input>                </span>                </li>                <li>                    <span class="list_left">属性</span>                    <span class="list_right">                    满<el-input v-model="edit_data.enough" placeholder="0.00" class="con_in"></el-input>减<el-input v-model="edit_data.dedut" placeholder="0.00" class="con_in"></el-input>                </span>                </li>                <li>                    <span class="list_left">数量</span>                    <span class="list_right">                    <el-input v-model="edit_data.coupon_num" placeholder="请输入数量" class="con_in"></el-input>                </span>                </li>            </ul>            <span slot="footer" class="dialog-footer">            <el-button @click="close">取 消</el-button>            <el-button type="primary" @click="edit()">确 定</el-button>          </span>        </el-dialog>    </template></div></body></html><script src="../js/jquery.min.js"></script><script src="../js/vue.js"></script><script src="../js/func.js"></script><script src="../js/index.js"></script><script>    new Vue({        el: '#app',        data: {            max_ht:0,            con_list:'',            addDialogVisible:false,            editDialogVisible:false,            coupon:{                num:'',                name:'',                type:1,                enough:'',                deductible:'',            },            edit_data:{                coupon_num:'',                coupon_name:'',                coupon_type:1,                enough:'',                dedut:'',                most:'',                id:'',                start:'',                end:'',            },            detail:''        },        methods: {            height(){                var height=window.innerHeight;                this.max_ht=window.innerHeight-110;            },            add(){                $.post(url(methods.CouponOperation),{data:this.coupon,type:'add'},v=>{                    console.log(v)                    if(v.code==1){                        this.$confirm('是否继续新增优惠券?', '提示', {                            confirmButtonText: '继续',                            cancelButtonText: '返回',                            type: 'warning'                        }).then(() => {                            this.coupon= {                                type: 1,                                name: '',                                num: '',                                enough: '',                                deductible: '',                            }                        }).catch(e => {                            this.close()                            this.get_cou()                        })                    }                })            },            get_cou(){                $.get(url(methods.getList),v=>{                    this.con_list=v.list;                })            },            setVal(){                this.edit_data.coupon_type = this.detail.coupon_type                this.edit_data.coupon_name = this.detail.coupon_name                this.edit_data.coupon_num = this.detail.coupon_num                this.edit_data.id = this.detail.id                this.edit_data.start= this.detail.start                this.edit_data.end= this.detail.end                this.edit_data.most = this.detail.most                this.edit_data.enough = this.detail.enough                this.edit_data.dedut= this.detail.deductible            },            edit(){                $.post(url(methods.CouponOperation),{data:this.edit_data,type:'modify'},v=>{                    if(v.code==1){                        success(v.Msg)                        this.editDialogVisible=false;                        this.get_cou()                    }else{                        error(v.errorMsg)                    }                })            },            del(id){                this.$confirm('确定删除此优惠券?', '提示', {                    confirmButtonText: '确定',                    cancelButtonText: '取消',                    type: 'warning'                }).then(() => {                    $.post(url(methods.CouponOperation),{data:id,type:'del'},v=> {                        console.log(v);                        if(v.code==1){                            success('删除成功')                            this.get_cou()                        }else{                            error(v.errorMsg)                        }                    })                })            },            close(){                this.addDialogVisible=false;                this.editDialogVisible=false;                this.coupon= {                    type: 1,                    name: '',                    num: '',                    enough: '',                    deductible: '',                };                this.edit_data={                    coupon_num:'',                        coupon_name:'',                        coupon_type:1,                        enough:'',                        dedut:'',                        most:'',                        id:'',                        start:'',                        end:'',                };            }        },        mounted() {            this.$nextTick(e=>{                //初始化                that = this;                this.height()                this.get_cou()                loginState()            })        }    })</script>